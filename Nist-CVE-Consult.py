import requests
from deep_translator import GoogleTranslator

translator =  GoogleTranslator(source='en', target='pt')

def get_cve_info(cve_id):
    url = f"https://services.nvd.nist.gov/rest/json/cves/2.0?cveId={cve_id}"
    response = requests.get(url)
    if response.status_code == 200:
        return response.json()
    else:
        return None
    




def main():
    cve_id = input("Digite o ID da CVE: ")
    cve_info = get_cve_info(cve_id)

    if cve_info and 'vulnerabilities' in cve_info:
        vulnerabilities = cve_info['vulnerabilities']
        for vulnerability in vulnerabilities:
            cve = vulnerability['cve']
            cve_id = cve['id']
            description = cve['descriptions'][0]['value']
            mitigation = cve['cisaRequiredAction']

            # Trduzindo o retorno da API para PTBR
            description = translator.translate(description)
            mitigation = translator.translate(mitigation)
            print(f"ID da CVE: {cve_id}")
            print(f"Descrição: {description}")
            print(f"Mitigação: {mitigation}")
            
    else:
        print("CVE não encontrada.")

if __name__ == "__main__":
    main()
